Save format with undo history.
Add sample mode in tools that should support it
